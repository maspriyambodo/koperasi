function isDivHeightVisible(e){var t=$(window).scrollTop(),d=t+$(window).height(),a=$(e).offset().top,i=a+$(e).height();return i>=t&&d>=a&&d>=i&&a>=t}function isDivWidthVisible(e){var t=$(window).scrollLeft(),d=t+$(window).width(),a=$(e).offset().left,i=a+$(e).width();return i>=t&&d>=a&&d>=i&&a>=t}!function(e){"use strict";e.fn.tautocomplete=function(t,d){function a(){if(""==h.ddTextbox.val())return void o();if(h.ddTableCaption.hide(),h.ddTextbox.addClass("loading"),null!=c.ajax){var t=null;t=e.isFunction(c.ajax.data)?c.ajax.data.call(this):c.ajax.data,e.ajax({type:c.ajax.type||"GET",dataType:"json",contentType:c.ajax.contentType||"application/json; charset=utf-8",headers:c.ajax.headers||{"Content-Type":"application/x-www-form-urlencoded"},data:t||null,url:c.ajax.url,success:i,error:function(e,t,d){h.ddTextbox.removeClass("loading"),alert("Error: "+e.status||" - "||d)}})}else if(e.isFunction(c.data)){var d=c.data.call(this);r(d)}}function i(t){if(null==c.ajax.success||""==c.ajax.success||"undefined"==typeof c.ajax.success)r(t);else if(e.isFunction(c.ajax.success)){var d=c.ajax.success.call(this,t);r(d)}}function l(){var e=h.ddTable.find("tbody").find(".selected");h.ddTextbox.data("id",e.find("td").eq(0).text()),h.ddTextbox.data("text",e.find("td").eq(1).text());for(var t=0;g>t;t++)v[c.columns[t]]=e.find("td").eq(t).text();h.ddTextbox.val(e.find("td").eq(1).text()),C.val(e.find("td").eq(0).text()+"#$#"+e.find("td").eq(1).text()),o(),n(),h.ddTextbox.focus()}function n(){e.isFunction(c.onchange)&&c.onchange.call(this)}function o(){h.ddTable.hide(),h.ddTextbox.removeClass("inputfocus"),h.ddDiv.removeClass("highlight"),h.ddTableCaption.hide()}function s(){var t=h.ddTextbox.height()+20+"px 1px 0px 1px",d="1px 1px "+(h.ddTextbox.height()+20)+"px 1px";h.ddDiv.css("top","0px"),h.ddDiv.css("left","0px"),h.ddTable.css("margin",t),h.ddTextbox.addClass("inputfocus"),h.ddDiv.addClass("highlight"),h.ddTable.show(),isDivHeightVisible(h.ddDiv)||(h.ddDiv.css("top",-1*h.ddTable.height()+"px"),h.ddTable.css("margin",d),isDivHeightVisible(h.ddDiv)||(h.ddDiv.css("top","0px"),h.ddTable.css("margin",t),e("html, body").animate({scrollTop:h.ddDiv.offset().top-60},250))),isDivWidthVisible(h.ddDiv)||h.ddDiv.css("left","-"+(h.ddTable.width()-h.ddTextbox.width()-20)+"px")}function r(e){try{h.ddTextbox.removeClass("loading"),h.ddTable.find("tbody").find("tr").remove();var t=null;if(null!=c.highlight)var d=!0,t=new RegExp(h.ddTextbox.val(),"gi");var a=0,i=0,l=null,n=null;if(null!=e)for(a=0;a<e.length;a++)if(!(a>=15)){var o=e[a];l="",i=0;for(var r in o)g>=i&&(n=o[r]+"",d&&(n=n.replace(t,"<span class='"+c.highlight+"'>$&</span>")),l=l+"<td>"+n+"</td>",i++);h.ddTable.append("<tr>"+l+"</tr>")}0==a&&h.ddTableCaption.show();for(var a=0;a<c.hide.length&&g>a;a++)c.hide[a]||h.ddTable.find("td:nth-child("+(a+1)+")").hide();h.ddTable.find("tbody").find("tr:first").addClass("selected"),s()}catch(x){alert("Error: "+x)}}var c=e.extend({width:"500px",columns:[],hide:[!1],onchange:null,norecord:"No Records Found",dataproperty:null,regex:"^[a-zA-Z0-9\b]+$",data:null,placeholder:null,theme:"default",ajax:null,delay:1e3,highlight:"word-highlight"},t),x={"default":"adropdown",classic:"aclassic",white:"awhite"};c.theme=x[c.theme];var h={ddDiv:e("<div>",{"class":c.theme}),ddTable:e("<table></table>",{style:"width:"+c.width}),ddTableCaption:e("<caption>"+c.norecord+"</caption>"),ddTextbox:e("<input type='text'>")},u={UP:38,DOWN:40,ENTER:13,TAB:9,BACKSPACE:8},f={columnNA:"Error: Columns Not Defined",dataNA:"Error: Data Not Available"},b={id:function(){return h.ddTextbox.data("id")},text:function(){return h.ddTextbox.data("text")},searchdata:function(){return h.ddTextbox.val()},settext:function(e){h.ddTextbox.val(e)},isNull:function(){return""==h.ddTextbox.data("text")||null==h.ddTextbox.data("text")?!0:!1},all:function(){return v}},p=function(){var e=0;return function(t,d){clearTimeout(e),e=setTimeout(t,d)}}(),v={},T=!1;this.is(":focus")&&(T=!0);var g=c.columns.length,C=this;this.wrap("<div class='acontainer'></div>"),this.after(h.ddTextbox),h.ddTextbox.attr("autocomplete","off"),h.ddTextbox.css("width",this.width+"px"),h.ddTextbox.css("font-size",this.css("font-size")),h.ddTextbox.attr("placeholder",c.placeholder),""==c.columns||null==c.columns?h.ddTextbox.attr("placeholder",f.columnNA):""!=c.data&&null!=c.data||null!=c.ajax||h.ddTextbox.attr("placeholder",f.dataNA),this.after(h.ddDiv),this.hide(),h.ddDiv.append(h.ddTable),h.ddTable.attr("cellspacing","0"),h.ddTable.append(h.ddTableCaption);for(var m="<thead><tr>",w=0;g-1>=w;w++)m=m+"<th>"+c.columns[w]+"</th>";m+="</thead></tr>",h.ddTable.append(m);var y="",D="";if(""!=this.val()){var j=this.val().split("#$#");y=j[0],D=j[1]}return h.ddTextbox.attr("data-id",y),h.ddTextbox.attr("data-text",D),h.ddTextbox.val(D),T&&h.ddTextbox.focus(),h.ddTextbox.keyup(function(e){return(e.keyCode<46||e.keyCode>105)&&e.keyCode!=u.BACKSPACE?void e.preventDefault():void p(function(){a()},c.delay)}),h.ddTextbox.keypress(function(e){var t=new RegExp(c.regex),d=String.fromCharCode(e.charCode?e.charCode:e.which);return t.test(d)?void 0:(e.preventDefault(),!1)}),h.ddTextbox.keydown(function(e){var t=h.ddTable.find("tbody"),d=t.find(".selected");e.keyCode==u.ENTER&&(e.preventDefault(),l()),e.keyCode==u.UP&&(h.ddTable.find(".selected").removeClass("selected"),0==d.prev().length?t.find("tr:last").addClass("selected"):d.prev().addClass("selected")),e.keyCode==u.DOWN&&(t.find(".selected").removeClass("selected"),0==d.next().length?t.find("tr:first").addClass("selected"):(h.ddTable.find(".selected").removeClass("selected"),d.next().addClass("selected")))}),h.ddTable.delegate("tr","mousedown",function(){h.ddTable.find(".selected").removeClass("selected"),e(this).addClass("selected"),l()}),h.ddTextbox.focusout(function(){if(o(),e(this).val()!=e(this).data("text")){var t=!0;""==e(this).data("text")&&(t=!1),e(this).data("text",""),e(this).data("id",""),e(this).val(""),C.val(""),t&&n()}}),b}}(jQuery);